function getGraph() {

	var fileArrayObject = getFiles();
	var bookArray = fileArrayObject.contents;
	var nameArray = fileArrayObject.bookName;
	var datasets = [];

document.getElementById('numWords').innerText = '';

bookArray.forEach(function(element, index, array) {
        var randomColorFactor = function() {
            return Math.round(Math.random() * 255);
        };
        var randomColor = function(opacity) {
            return 'rgba(' + randomColorFactor() + ',' + randomColorFactor() + ',' + randomColorFactor() + ',' + (opacity || '.3') + ')';
        };

        var n = array.length/10;
        var chapArray = [];

        for (var i = 0; i < array.length; i+=n){
        	chapArray.push(array.substring(i, i+n));
        }

          //chapArray is an array where each element
          //is an array containing the entire text in that chapter
          //chapters is an array where each element
          //is an array containing an array of the words in that chapter
         // var chapArray = array.split(/CHAPTER/);
          var chapters = new Array(chapArray.length);
          
          chapArray.forEach(function (element, index, array) {
            chapters[index] = element.toLowerCase().replace(/[^a-zA-Z '\n]/g, '').split(/\s+/);
          })
          
          //create the labels for the x-axis
          var xLabels = [];
          for (var i = 0; i<chapArray.length; i++)
          {
            var current = "Chapter " + i;
            xLabels.push(current);
          }

          //get user input for word to graph
          var wordInput = document.getElementById('wordInput').value;
          wordInput = wordInput.toString().toLowerCase().split(/, */);

          
          //for each input word, go through each chapter counting 
          //the occurences of the word and push to count array
          wordInput.forEach(function(element, index, array) {
            var wordTotal = 0;
            var wordData = [];
            chapters.forEach(function(element2, index2, array2) {
              var wordCount = countWords(array2[index2]);
              var idx = wordCount.words.indexOf(element);
              if (idx != -1) {
                var numCount = wordCount.count[idx];
                wordData.push(numCount);

              }
              else {
                wordData.push(0);
              }
            })

            //count total occurence of word
            for (var j = 0; j<wordData.length; j++) {
             var currNum = Number(wordData[j]);
             wordTotal += currNum;
            }

            //make new dataset from wordData
            var newDataset = {
                label: element,
                borderColor: randomColor(0.4),
                pointBorderColor: randomColor(0.7),
                pointBorderWidth: 1,
                data: wordData,
            };

            datasets.push(newDataset);
            console.log(datasets);

              document.getElementById('numWords').innerText += "In " + fileArrayObject.bookName[index] + " " + element + "had " + wordTotal + " appearances\n";
              
              

          })
	
	})

}

makeGraph(xLabels, datasets);